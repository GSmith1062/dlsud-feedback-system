<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <title>Student Feedback Log</title>
</head>
<body>
    <header class="header">
        <a href="#"><p>FEEDBACK LOG</p></a>
        <a href="./profile.html"><p>PROFILE</p></a>
        <a href="#"><p>LOG OUT</p></a>
    </header>

    <div class="feedback-log-container">
        <aside class="sidebar">
            <div class="sidebar-options">
                <div class="sidebar-option">
                    <button class="write-feedback-btn">
                        <span>Write Feedback</span>
                    </button>
                </div>
                <div class="sidebar-option"><p>All Feedback</p></div>
                <div class="sidebar-option"><p>Pending</p></div>
                <div class="sidebar-option"><p>Ongoing</p></div>
                <div class="sidebar-option"><p>Resolved</p></div>
            </div>
        </aside>

        <main class="feedback-log">
            <div id="feedback-table">
                <table>
                    <thead>
                        <tr>
                            <th class="feedback-title">Feedback</th>
                            <th class="feedback-category">Category</th>
                            <th class="feedback-status">Status</th>
                            <th class="feedback-date">Date Submitted</th>
                        </tr>
                    </thead>
                    <tbody id="feedback-items">
                        <!-- feedback items will be added here -->
                    </tbody>
                </table>
            </div>
            <div id="feedback-content-container" class="feedback-hidden">
                <div class="header-content">
                    <div class="left-icons">
                        <i class="fas fa-arrow-left" onclick="goBack()"></i>
                    </div>
                    <div class="status">
                        <span class="status-text"></span>
                        <span class="status-badge"></span>
                    </div>
                    <div class="date"></div>
                </div>
                <div class="feedback-content">
                    <div class="to"></div>
                    <div class="from"></div>
                    <div class="subject"></div>
                    <div class="body"></div>
                </div>
                <div id="status-updates"></div>
            </div>
        </main>
        
        <script>
            // Static example feedback data
            const feedbackData = [
                { text: "Make Monday to Friday holidays so we can enjoy life", category: "Suggestion", status: "Pending", date: "June 9, 2024", to:"Collegiate Office", from: "Charles Smith Gamilla &lt;ace0369@dlsud.edu.ph&gt;",
                    body: "The amber droplet hung from the branch, reaching fullness and ready to drop. It waited. While many of the other droplets were satisfied to form as big as they could and release, this droplet had other plans. It wanted to be part of history. It wanted to be remembered long after all the other droplets had dissolved into history. So it waited for the perfect specimen to fly by to trap and capture that it hoped would eventually be discovered hundreds of years in the future.",
                    updates: [
                        { title: "Status Update - Ongoing", body: "We are working on your suggestion." }
                    ] },
                { text: "Improve the Wi-Fi in the library for better student experience", category: "Concern", status: "Ongoing", date: "October 1, 2024" },
                { text: "Reduce the tuition fees as it is too expensive", category: "Suggestion", status: "Resolved", date: "November 1, 2024" },
                { text: "Introduce more courses on Artificial Intelligence", category: "Suggestion", status: "Pending", date: "September 20, 2024" }
            ];
            
            // status color
            function renderFeedback(feedback, index) {
                const feedbackRow = document.createElement('tr'); // creates a table row
        
                // color classes based on status
                const statusClasses = {
                    "Pending": "pending",
                    "Ongoing": "ongoing",
                    "Resolved": "resolved"
                };
        
                const statusClass = statusClasses[feedback.status] || "pending";  // Default to pending
        
                feedbackRow.innerHTML = `
                    <td class="feedback-text">${feedback.text.length > 50 ? feedback.text.slice(0, 50) + "..." : feedback.text}</td>
                    <td class="feedback-category">${feedback.category}</td>
                    <td class="feedback-status"><div class="status-background ${statusClass}">${feedback.status}</div></td>
                    <td class="feedback-date">${feedback.date}</td>
                `;
                feedbackRow.addEventListener('click', () => displayFeedback(index));
                document.getElementById('feedback-items').appendChild(feedbackRow);
            }
            
            function displayFeedback(index){
                const feedback = feedbackData[index];
                document.querySelector('.status-text').textContent = feedback.category;
                document.querySelector('.status-badge').textContent = feedback.status;
                document.querySelector('.status-badge').className = `status-badge ${feedback.status.toLowerCase()}`;
                document.querySelector('.date').textContent = feedback.date;
                document.querySelector('.to').innerHTML = `To ${feedback.to || 'N/A'}`;
                document.querySelector('.from').innerHTML = `<span class="name">${feedback.from.split('&lt;')[0]}</span> <span class="email">&lt;${feedback.from.split('&lt;')[1]}</span>`;
                document.querySelector('.subject').textContent = feedback.text;
                document.querySelector('.body').textContent = feedback.body;

                const updatesDiv = document.getElementById('status-updates');
                updatesDiv.innerHTML = feedback.updates ? feedback.updates.map(update => `
                    <div><strong>${update.title}</strong>: ${update.body}</div>
                `).join('') : '';
                
                document.getElementById('feedback-content-container').classList.remove('feedback-hidden');
                document.getElementById('feedback-table').classList.add('feedback-hidden');
            }
            
            
            function goBack() {
                document.getElementById('feedback-content-container').classList.add('feedback-hidden');
                document.getElementById('feedback-table').classList.remove('feedback-hidden');
            }

            document.addEventListener('DOMContentLoaded', () => {
                feedbackData.forEach(renderFeedback);
            });
    
        </script>        
    </div>
</body>
</html>
