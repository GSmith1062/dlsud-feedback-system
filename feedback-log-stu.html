<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="feedback-log.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <title>Student Feedback Log</title>
</head>
<body>
    <header class="header">
        <a href="./dashboard-stu.html"><p>HOME</p></a>
        <a href="./profile.html"><p>PROFILE</p></a>
        <a href="#" id="logout-link"><p>LOG OUT</p></a>
    </header>

    <div class="feedback-log-container">
        <aside class="sidebar">
            <div class="sidebar-options">
                <div class="sidebar-option">
                    <button class="write-feedback-btn">
                        <i><img src = "./icons/pencil.svg"></i>
                        <span>Write Feedback</span>
                    </button>
                </div>

                <div class="sidebar-option menu-item active" onclick="toggleActive(this)">
                    <i class="fas fa-inbox"></i>
                    <span>All Feedback</span>
                </div>
                <div class="sidebar-option menu-item" onclick="toggleActive(this)">
                    <span class="status-dot pending"></span>
                    <span>Pending</span>
                </div>
                <div class="sidebar-option menu-item" onclick="toggleActive(this)">
                    <span class="status-dot ongoing"></span>
                    <span>Ongoing</span>
                </div>
                <div class="sidebar-option menu-item" onclick="toggleActive(this)">
                    <span class="status-dot resolved"></span>
                    <span>Resolved</span>
                </div>
                <div class="sidebar-option menu-item" onclick="toggleActive(this)">
                    <span class="sort-this-week"></span>
                    <span>This Week</span>
                </div>
                <div class="sidebar-option menu-item" onclick="toggleActive(this)">
                    <span class="sort-this-month"></span>
                    <span>Date within</span>
                </div>
            </div>
        </aside>

        <main class="feedback-log">
            <div id="feedback-table">
                <table>
                    <colgroup>
                        <col style = "width: 70%;">
                        <col style = "width: 20%;">
                        <col style = "width: 20%;">
                        <col style = "width: 20%;">
                    </colgroup>
                    <thead>
                        <tr>
                            <th class="feedback-title">Feedback</th>
                            <th class="feedback-type">Type</th>
                            <th class="feedback-status">Status</th>
                            <th class="feedback-date">Date Submitted</th>
                        </tr>
                    </thead>
                    <tbody id="feedback-items">
                        <!-- feedback items will be added here -->
                    </tbody>
                </table>
            </div>
            <div id="feedback-content-container" class="feedback-hidden">
                <div class="header-content">
                    <div class="left-icons">
                        <i class="fas fa-arrow-left" onclick="goBack()"></i>
                    </div>
                    <div class="status">
                        <span class="header-type"></span>
                        <span class="status-badge"></span>
                    </div>
                    <div class="date"></div>
                </div>
                <div class="feedback-content">
                    <div class="to"></div>
                    <div class="from"></div>
                    <div class="subject"></div>
                    <div class="body"></div>
                </div>
                <div id="status-updates"></div>
            </div>
        </main>
        
        <script>
            // Static example feedback data
            const feedbackData = [
                { text: "Make Monday to Friday holidays so we can enjoy life - Testing for long titles as long as it can carry 100 characters haha", type: "Suggestion", status: "Ongoing", date: "June 9, 2024", to:"Collegiate Office", from: "Charles Smith Gamilla &lt;ace0369@dlsud.edu.ph&gt;",
                    body: "The amber droplet hung from the branch, reaching fullness and ready to drop. It waited. While many of the other droplets were satisfied to form as big as they could and release, this droplet had other plans. It wanted to be part of history. It wanted to be remembered long after all the other droplets had dissolved into history. So it waited for the perfect specimen to fly by to trap and capture that it hoped would eventually be discovered hundreds of years in the future.",
                    updates: [
                        { title: "Status Update - Ongoing", body: "We are working on your suggestion." },
                        { title: "Status Update - Ongoing", body: "We are working on your suggestion." },
                        { title: "Status Update - Ongoing", body: "We are working on your suggestion." },
                        { title: "Status Update - Ongoing", body: "We are working on your suggestion." },
                    ] },
                    { text: "Make Monday to Friday holidays so we can enjoy life", type: "Suggestion", status: "Pending", date: "June 9, 2024", to:"Collegiate Office", from: "Charles Smith Gamilla &lt;ace0369@dlsud.edu.ph&gt;",
                    body: "The amber droplet hung from the branch, reaching fullness and ready to drop. It waited. While many of the other droplets were satisfied to form as big as they could and release, this droplet had other plans. It wanted to be part of history. It wanted to be remembered long after all the other droplets had dissolved into history. So it waited for the perfect specimen to fly by to trap and capture that it hoped would eventually be discovered hundreds of years in the future. The amber droplet hung from the branch, reaching fullness and ready to drop. It waited. While many of the other droplets were satisfied to form as big as they could and release, this droplet had other plans. It wanted to be part of history. It wanted to be remembered long after all the other droplets had dissolved into history. So it waited for the perfect specimen to fly by to trap and capture that it hoped would eventually be discovered hundreds of years in the future. The amber droplet hung from the branch, reaching fullness and ready to drop. It waited. While many of the other droplets were satisfied to form as big as they could and release, this droplet had other plans. It wanted to be part of history. It wanted to be remembered long after all the other droplets had dissolved into history. So it waited for the perfect specimen to fly by to trap and capture that it hoped would eventually be discovered hundreds of years in the future.",
                    updates: [
                        { title: "Status Update - Ongoing", body: "We are working on your suggestion. The amber droplet hung from the branch, reaching fullness and ready to drop. It waited. While many of the other droplets were satisfied to form as big as they could and release, this droplet had other plans. It wanted to be part of history. It wanted to be remembered long after all the other droplets had dissolved into history. So it waited for the perfect specimen to fly by to trap and capture that it hoped would eventually be discovered hundreds of years in the future." },
                        { title: "Status Update - Ongoing", body: "We are working on your suggestion." },
                        { title: "Status Update - Ongoing", body: "We are working on your suggestion." },
                    ] },
                    { text: "Make Monday to Friday holidays so we can enjoy life", type: "Suggestion", status: "Resolved", date: "June 9, 2024", to:"Collegiate Office", from: "Charles Smith Gamilla &lt;ace0369@dlsud.edu.ph&gt;",
                    body: "The amber droplet hung from the branch, reaching fullness and ready to drop. It waited. While many of the other droplets were satisfied to form as big as they could and release, this droplet had other plans. It wanted to be part of history. It wanted to be remembered long after all the other droplets had dissolved into history. So it waited for the perfect specimen to fly by to trap and capture that it hoped would eventually be discovered hundreds of years in the future.",
                    updates: [
                        { title: "Status Update - Ongoing", body: "We are working on your suggestion." },
                        { title: "Status Update - Resolved", body: "We are working on your suggestion." },
                    ] },
            ];
            
            // color classes based on status
            const statusClasses = {
                "Pending": "pending",
                "Ongoing": "ongoing",
                "Resolved": "resolved"
            };

            // status color

            // TABLE FEEDBACK LOG 
            function renderFeedback(feedback, index) {
                const feedbackRow = document.createElement('tr'); // table row
        
                const statusClass = statusClasses[feedback.status] || "pending";  // Default to pending
        
                feedbackRow.innerHTML = `
                    <td class="feedback-text">${feedback.text.length > 100 ? feedback.text.slice(0, 100) + "..." : feedback.text}</td>
                    <td class="feedback-type">${feedback.type}</td>
                    <td class="feedback-status"><div class="status-background ${statusClass}">${feedback.status}</div></td>
                    <td class="feedback-date">${feedback.date}</td>
                `;
                feedbackRow.addEventListener('click', () => displayFeedback(index));
                document.getElementById('feedback-items').appendChild(feedbackRow);
            }
            
            // FEEDBACK VIEW
            function displayFeedback(index){
                const feedback = feedbackData[index];
                document.querySelector('.header-type').textContent = feedback.type;

                const statusClass = statusClasses[feedback.status] || "pending";  // Default to pending
                const statusText = document.querySelector('.status-badge');
                statusText.textContent = feedback.status; 
                statusText.className = `status-badge ${statusClass}`; 

                document.querySelector('.date').textContent = feedback.date;
                document.querySelector('.to').innerHTML = `To ${feedback.to || 'N/A'}`;
                document.querySelector('.from').innerHTML = `<span class="name">${feedback.from.split('&lt;')[0]}</span> <span class="email">&lt;${feedback.from.split('&lt;')[1]}</span>`;
                document.querySelector('.subject').textContent = feedback.text;
                document.querySelector('.body').textContent = feedback.body;

                const updatesDiv = document.getElementById('status-updates');
                updatesDiv.innerHTML = feedback.updates ? feedback.updates.map(update => `
                    <div class="status-update">
                        <div class="status-title">${update.title}</div>
                        <div class="status-from">${feedback.from}</div>
                        <div class="status-body">${update.body}</div>
                    </div>
                `).join('') : '';
                
                document.getElementById('feedback-content-container').classList.remove('feedback-hidden');
                document.getElementById('feedback-table').classList.add('feedback-hidden');
            }
            
            
            function goBack() {
                document.getElementById('feedback-content-container').classList.add('feedback-hidden');
                document.getElementById('feedback-table').classList.remove('feedback-hidden');
            }

            // sidebar buttons
            function toggleActive(element) {
            var items = document.querySelectorAll('.menu-item');
            items.forEach(function(item) {
                item.classList.remove('active');
            });

            element.classList.add('active');
            }


            document.addEventListener('DOMContentLoaded', () => {
                feedbackData.forEach(renderFeedback);
            });
    
        </script>        
    </div>
    <script type="module" src="auth.js"></script>
</body>
</html>
